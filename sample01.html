<!doctype html>
<html lang="en">
  <head>

    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="description" content="Sample of detailed service worker registration events.">

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Service Worker Sample: Detailed Registration</title>

  </head>

  <body>
  <h1>Service Worker Sample: Detailed Registration</h1>

  Service Workers <strong id="availability"></strong> available in your browser.

  <h2>Info about the Current Registration</h2>
    <p>
      The <code>navigator.serviceWorker.register()</code> call <strong id="register"></strong>.
    </p>
    <p>
      The current registration represents the <strong id="kind"></strong> service worker.
    </p>

  <script>
    if ('serviceWorker' in navigator) {

      document.querySelector('#availability').textContent = 'are';

      navigator.serviceWorker.register('service-worker.js', {
          scope: './'
      }).then(function (registration) {
          var serviceWorker;
          if (registration.installing) {
              serviceWorker = registration.installing;
              document.querySelector('#kind').textContent = 'installing';
          } else if (registration.waiting) {
              serviceWorker = registration.waiting;
              document.querySelector('#kind').textContent = 'waiting';
          } else if (registration.active) {
              serviceWorker = registration.active;
              document.querySelector('#kind').textContent = 'active';
          }
          if (serviceWorker) {
              // logState(serviceWorker.state);
              serviceWorker.addEventListener('statechange', function (e) {
                  // logState(e.target.state);
              });
          }
      }).catch (function (error) {
          // Something went wrong during registration. The service-worker.js file
          // might be unavailable or contain a syntax error.
          document.querySelector('#register').textContent = 'failed: ' + error;
      });
    } else {
      // The current browser doesn't support service workers.
      document.querySelector('#availability').textContent = 'are not';
    }
  </script>

  </body>
</html>
